<!DOCTYPE html>
<!-- saved from url=(0052)http://getbootstrap.com/docs/4.0/examples/dashboard/ -->
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>编辑用户信息</title>
    <!-- Bootstrap core CSS -->
    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link th:href="@{/css/dashboard.css}" rel="stylesheet">
    <style type="text/css">
        /* Chart.js */
        
        @-webkit-keyframes chartjs-render-animation {
            from {
                opacity: 0.99
            }
            to {
                opacity: 1
            }
        }
        
        @keyframes chartjs-render-animation {
            from {
                opacity: 0.99
            }
            to {
                opacity: 1
            }
        }
        
        .chartjs-render-monitor {
            -webkit-animation: chartjs-render-animation 0.001s;
            animation: chartjs-render-animation 0.001s;
        }
    </style>
</head>

<body>
    <div th:replace="~{commons/common::topbar}"></div>
    <div class="container-fluid">
        <div class="row">
            <div th:replace="~{commons/common::sidebar(active='user')}"></div>
            <main role="main" class="col-md-9 ml-sm-auto col-lg-10 pt-3 px-4">
                <h2>编辑用户信息</h2>
                <div class="alert alert-danger" role="alert" th:if="${errorMsg != null}">
                    <strong>错误：</strong>[[${errorMsg}]]
                </div>
                <form method="post" th:action="@{/user/update}">
                    <input type="hidden" name="userId" th:value="${user?.userId}">
                    <div class="form-group" th:if="${user?.userId != null}">
                        <label for="userId">用户ID：</label>
                        <input type="text" th:value="${user?.userId}" class="form-control" id="userId" readonly>
                        <small class="form-text text-muted">用户ID新增后不可修改</small>
                    </div>
                    <div class="form-group">
                        <label for="username">用户名：</label>
                        <input type="text" name="username" th:value="${user?.username}" class="form-control" id="username" 
                               placeholder="请输入用户名" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">手机号：</label>
                        <input type="text" name="phone" th:value="${user?.phone}" class="form-control" id="phone" 
                               placeholder="请输入手机号" required pattern="[0-9]{11}" title="请输入11位手机号">
                    </div>
                    <div class="form-group">
                        <label for="roleId">角色：</label>
                        <select name="roleId" class="form-control" id="roleId" 
                                th:value="${user?.roleId}" required>
                            <option value="">请选择角色</option>
                            <option th:each="role : ${roleList}" 
                                    th:value="${role.roleId}" 
                                    th:text="${role.roleName} + ' (' + ${role.roleId} + ')'"
                                    th:selected="${user?.roleId == role.roleId}">
                            </option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="birthday">生日：</label>
                        <input type="date" name="birthday" th:value="${user?.birthday}" class="form-control" id="birthday" 
                               placeholder="请选择生日">
                    </div>
                    <div class="form-group">
                        <label>性别：</label>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sex" id="sexMale" value="男" 
                                   th:checked="${user?.sex == '男'}">
                            <label class="form-check-label" for="sexMale">男</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sex" id="sexFemale" value="女" 
                                   th:checked="${user?.sex == '女'}">
                            <label class="form-check-label" for="sexFemale">女</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="sex" id="sexUnknown" value="未知" 
                                   th:checked="${user?.sex == null or user?.sex == '未知'}">
                            <label class="form-check-label" for="sexUnknown">未知</label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="imgUrl">头像：</label>
                        <div class="input-group">
                            <input type="text" name="imgUrl" th:value="${user?.imgUrl}" class="form-control" id="imgUrl" 
                                   placeholder="头像地址（暂不支持上传，请输入图片URL）" readonly>
                            <div class="input-group-append">
                                <span class="input-group-text">默认头像</span>
                            </div>
                        </div>
                        <small class="form-text text-muted">当前版本暂不支持图片上传，使用默认头像</small>
                    </div>
                    <button type="submit" class="btn btn-primary">保存</button>
                    <button type="reset" class="btn btn-secondary">重置</button>
                    <a class="btn btn-outline-secondary" href="/user/list">返回</a>
                </form>
            </main>
        </div>
    </div>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/javascript" th:src="@{/js/jquery-3.2.1.slim.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/popper.min.js}"></script>
    <script type="text/javascript" th:src="@{/js/bootstrap.min.js}"></script>

    <!-- Icons -->
    <script type="text/javascript" th:src="@{/js/feather.min.js}"></script>
    <script>
        feather.replace()
        
        // 表单提交前的验证
        document.querySelector('form').addEventListener('submit', function(e) {
            let roleId = document.getElementById('roleId').value;
            if (!roleId) {
                alert('请选择角色');
                e.preventDefault();
                return false;
            }
            
            let phone = document.getElementById('phone').value;
            if (phone && !/^[0-9]{11}$/.test(phone)) {
                alert('请输入11位手机号');
                e.preventDefault();
                return false;
            }
        });
    </script>

</body>

</html>